<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Adstock-Weights-and-Transformations • tidymmm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Adstock-Weights-and-Transformations">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidymmm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Adstock-Weights-and-Transformations.html">Adstock-Weights-and-Transformations</a></li>
    <li><a class="dropdown-item" href="../articles/MMM-With-Carryover-And-Saturation.html">MMM-With-Carryover-And-Saturation</a></li>
    <li><a class="dropdown-item" href="../articles/Tuning-Carryover-and-Saturation-Hyperparameters.html">Tuning-Carryover-and-Saturation-Hyperparameters</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Adstock-Weights-and-Transformations</h1>
            
      

      <div class="d-none name"><code>Adstock-Weights-and-Transformations.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="app">App<a class="anchor" aria-label="anchor" href="#app"></a>
</h2>
<iframe src="https://bdshaff.shinyapps.io/adstock_transformations/" width="100%" height="400" frameborder="no"></iframe>
</div>
<div class="section level2">
<h2 id="geometric-adstock-weights">Geometric Adstock Weights<a class="anchor" aria-label="anchor" href="#geometric-adstock-weights"></a>
</h2>
<p>The function for geometric adstock weights has the following
form:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>,</mo><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>θ</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">
w(\theta,l) = \theta^l
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>∈</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mi>L</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mn>0</mn><mo>&lt;</mo><mi>θ</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">
l \in[0,L-1], 0&lt;\theta&lt;1
</annotation></semantics></math></p>
<p>see <a href="https://research.google/pubs/bayesian-methods-for-media-mix-modeling-with-carryover-and-shape-effects/" class="external-link">Bayesian
Methods for Media Mix Modeling with Carryover and Shape Effects</a></p>
<div class="section level4">
<h4 id="normalized">Normalized<a class="anchor" aria-label="anchor" href="#normalized"></a>
</h4>
<p><code>normalize</code> is set to <code>TRUE</code> by default so the
sum of the weights will be <code>1</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/geometric_adstock_weights.html">geometric_adstock_weights</a></span><span class="op">(</span>decay <span class="op">=</span> <span class="fl">0.1</span>, max_carryover <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/geometric_adstock_weights.html">geometric_adstock_weights</a></span><span class="op">(</span>decay <span class="op">=</span> <span class="fl">0.9</span>, max_carryover <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>the length of the result will equal to <code>max_carryover</code> -
that is the function of the parameter</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 8</span></span></code></pre></div>
<p>Setting <code>normalize = FALSE</code> will return unscaled
weights</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/geometric_adstock_weights.html">geometric_adstock_weights</a></span><span class="op">(</span>decay <span class="op">=</span> <span class="fl">0.2</span>, normalize <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/geometric_adstock_weights.html">geometric_adstock_weights</a></span><span class="op">(</span>decay <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="co">#] not normalized</span></span>
<span><span class="co">#&gt; [1] 1.25</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span> <span class="co">#] normalized</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="changing-the-decay-rate">Changing the Decay Rate<a class="anchor" aria-label="anchor" href="#changing-the-decay-rate"></a>
</h3>
<p>Keeping <code>max_carryover = 5</code> constant and varying the decay
rate shows that a small decay rate leads to a small amount of ad
exposure volume being carried over into the future while a large decay
rate will carry over more of the exposure volume. The choice for the
rate will depend on both the medium/channel/tactic/independent variable
being included, as well as the dependent variable. For example <em>sales
of durable goods</em> like cars or washing machines may require a larger
carry over in ad exposure variables than <em>subscriptions to a
streaming service</em>. Likewise OOH Brand advertising may require a
larger decay rate than a digital re-targeting tactics.</p>
<p><img src="Adstock-Weights-and-Transformations_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
<p>There is the option of no normalizing the weights however this will
lead to ad exposure inflation and applying the adstock transformation to
the data. This may make sense to do if contextual it is known that ad
exposure for a given channel is unreported - however this is best
handled in data preparation rather than modeling and so the default
behavior is to normalize the weights.</p>
<p><img src="Adstock-Weights-and-Transformations_files/figure-html/unnamed-chunk-9-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="changing-maximum-carryover">Changing Maximum Carryover<a class="anchor" aria-label="anchor" href="#changing-maximum-carryover"></a>
</h3>
<p>Having seen the effect of changing the decay rate we can now explore
the effects of smaller and larger <code>max_carryover</code> parameter.
We’ll keep <code>decay rate = 0.6</code>. You can see in the plots that
when maximum carryover is set to 1 no carryover will take place. For any
decay rate the <strong>normalized</strong> weight will be one. As we
increase the maximum carryover there is a visible effect up to around ~7
after which the tail end of the weights becomes very small and thus has
a small effect.</p>
<p><img src="Adstock-Weights-and-Transformations_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="adstock-transformations">Adstock Transformations<a class="anchor" aria-label="anchor" href="#adstock-transformations"></a>
</h2>
<p>Let’s now apply these weight to sample data:</p>
<div class="section level3">
<h3 id="changing-decay-rate">Changing Decay Rate<a class="anchor" aria-label="anchor" href="#changing-decay-rate"></a>
</h3>
<p>When applying the geometric adstock to the data you can see that the
higher decay rate has a smoothing effect wherein both the peaks and the
troughs of the original data are dampened and lifted. The larger the
decay rate the stronger the smoothing.</p>
<p><img src="Adstock-Weights-and-Transformations_files/figure-html/unnamed-chunk-11-1.png" width="768"><img src="Adstock-Weights-and-Transformations_files/figure-html/unnamed-chunk-11-2.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="changing-maximum-carryover-1">Changing Maximum Carryover<a class="anchor" aria-label="anchor" href="#changing-maximum-carryover-1"></a>
</h3>
<p>As we saw with the weights - the maximum carryover parameter is
really a parameter that unlocks the decay rate and allows it to come
into full effect. As a result we see that when we keep the dacay rate
constant at 0.6 the transformation only kicks in at max carryover &gt;
1. The impact of changing the maximum carryover then diminishes with
virtually no effect between 8-12.</p>
<p><img src="Adstock-Weights-and-Transformations_files/figure-html/unnamed-chunk-12-1.png" width="768"><img src="Adstock-Weights-and-Transformations_files/figure-html/unnamed-chunk-12-2.png" width="768"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ben Denis Shaffer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
